
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Thread Tutorial</title> 
<meta name="author" content="CoActionOS, Inc">

<!-- Enable responsive viewport -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
<!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- Le styles -->
<link href="/assets/themes/twitter/bootstrap3/css/bootstrap.min.css" rel="stylesheet">
<script src="/assets/themes/twitter/bootstrap3/js/jquery-2.0.3.min.js"></script>
<script src="/assets/themes/twitter/bootstrap3/js/bootstrap.min.js"></script>
<link href="/assets/themes/twitter/bootstrap3/css/font-awesome.min.css" rel="stylesheet">
<link href="/assets/themes/twitter/css/style.css" rel="stylesheet">
<link href="/assets/themes/twitter/css/syntax.css" rel="stylesheet">

<!-- Le fav and touch icons -->
<!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

<!-- atom & rss feed -->
<link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
<link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

</head>

<body style="min-height: 200px; padding-top: 50px;">

	<header class="navbar navbar-inverse navbar-fixed-top bs-docs-nav" role="banner">
		<div class="container">
			<div class="row">
				<div class="col-md-offset-1 col-md-9">
					<div class="navbar-header">
						<button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".menu-navbar-collapse">
							<span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
						</button>
						<a class="navbar-brand" href="/index.html">
							<img style="height: 22px;" src="/images/CoActionOS-Logo.svg" />
						</a>
					</div>

					<!-- Collect the nav links, forms, and other content for toggling -->
					<div class="collapse navbar-collapse menu-navbar-collapse" role="navigation">
						<ul class="nav navbar-nav">
							<li><a href="#"><i class="fa fa-phone"></i> Services</a></li>
							<li><a href="https://github.com/CoActionOS"><i class="fa fa-code-fork"></i> Code</a></li>
							<li><a href="/downloads.html"><i class="fa fa-cloud-download"></i> Downloads</a></li>
							<li><a href="/tutorials.html"><i class="fa fa-file-text-o"></i> Tutorials</a></li>
							<li><a href="/tips.html"><i class="fa fa-tags"></i> Tips</a></li>
						</ul>
						<ul class="nav navbar-nav navbar-right">
							<li><a href="#"><i class="fa fa-info-circle"></i> About</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</header>

	<div class="content" id="content">
		<div class="container">
			<div class="row">
				<div class="col-md-offset-1 col-md-7">
<div class="page-header">
  <h1>Thread Tutorial <small>CoActionOS Tutorial</small></h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>24 December 2013</span>
    </div>
    <div class="content">
      <p>h1. CoActionOS Thread Tutorial</p>

<p>CoActionOS Applib includes a Thread class for easily initializing and running threads. For more details on using this class, please see the <a href="/redmine/projects/coactionos-applib/embedded/class_thread.html">Thread Applib documentation</a>.</p>
<div class='highlight'><pre><code class='cpp'><span class='cp'>#include &lt;applib/Thread.hpp&gt; </span><span class='c1'>//for Thread class</span>
<span class='cp'>#include &lt;applib/Timer.hpp&gt;</span>
<span class='cp'>#include &lt;cstdio&gt; </span><span class='c1'>//for printf</span>
 
<span class='c1'>//function to execute with thread</span>
<span class='k'>static</span> <span class='kt'>void</span> <span class='o'>*</span> <span class='nf'>thread_func</span><span class='p'>(</span><span class='kt'>void</span> <span class='o'>*</span> <span class='n'>args</span><span class='p'>);</span>
 
<span class='kt'>int</span> <span class='nf'>main</span><span class='p'>(</span><span class='kt'>int</span> <span class='n'>argc</span><span class='p'>,</span> <span class='kt'>char</span> <span class='o'>*</span> <span class='n'>argv</span><span class='p'>[]){</span>
  <span class='n'>Thread</span> <span class='n'>t0</span><span class='p'>;</span> <span class='c1'>//construct the first thread class</span>
  <span class='n'>Thread</span> <span class='n'>t1</span><span class='p'>;</span> <span class='c1'>//construct the second thread class</span>
  <span class='kt'>int</span> <span class='n'>t0_args</span> <span class='o'>=</span> <span class='mi'>0</span><span class='p'>;</span> <span class='c1'>//argument for t0</span>
  <span class='kt'>int</span> <span class='n'>t1_args</span> <span class='o'>=</span> <span class='mi'>1</span><span class='p'>;</span> <span class='c1'>//argument for t1</span>
 
  <span class='c1'>//create and run t0</span>
  <span class='n'>t0</span><span class='p'>.</span><span class='n'>create</span><span class='p'>(</span><span class='n'>thread_func</span><span class='p'>,</span> <span class='o'>&amp;</span><span class='n'>t0_args</span><span class='p'>);</span>
 
  <span class='c1'>//create and run t1</span>
  <span class='n'>t1</span><span class='p'>.</span><span class='n'>create</span><span class='p'>(</span><span class='n'>thread_func</span><span class='p'>,</span> <span class='o'>&amp;</span><span class='n'>t1_args</span><span class='p'>);</span>
 
  <span class='c1'>//wait for the threads to complete</span>
  <span class='n'>Timer</span><span class='o'>::</span><span class='n'>wait_sec</span><span class='p'>(</span><span class='mi'>10</span><span class='p'>);</span>
 
  <span class='c1'>//all done</span>
  <span class='n'>printf</span><span class='p'>(</span><span class='s'>&quot;done</span><span class='se'>\n</span><span class='s'>&quot;</span><span class='p'>);</span>
  <span class='k'>return</span> <span class='mi'>0</span><span class='p'>;</span>
<span class='p'>}</span>
 
<span class='kt'>void</span> <span class='o'>*</span> <span class='nf'>thread_func</span><span class='p'>(</span><span class='kt'>void</span> <span class='o'>*</span> <span class='n'>args</span><span class='p'>){</span>
  <span class='kt'>int</span> <span class='o'>*</span> <span class='n'>x</span> <span class='o'>=</span> <span class='p'>(</span><span class='kt'>int</span><span class='o'>*</span><span class='p'>)</span><span class='n'>args</span><span class='p'>;</span>
  <span class='n'>printf</span><span class='p'>(</span><span class='s'>&quot;This thread was passed %d</span><span class='se'>\n</span><span class='s'>&quot;</span><span class='p'>,</span> <span class='o'>*</span><span class='n'>x</span><span class='p'>);</span>
  <span class='n'>Timer</span><span class='o'>::</span><span class='n'>wait_sec</span><span class='p'>(</span><span class='mi'>8</span><span class='p'>);</span>
  <span class='n'>printf</span><span class='p'>(</span><span class='s'>&quot;Thread %d is completing</span><span class='se'>\n</span><span class='s'>&quot;</span><span class='p'>,</span> <span class='o'>*</span><span class='n'>x</span><span class='p'>);</span>
  <span class='k'>return</span> <span class='n'>x</span><span class='p'>;</span>
<span class='p'>}</span>
</code></pre></div>
<p>The threads can be analyzed while they are running by using the Monitor view in CoActionOS Link. The following screen shot shows the running tasks while all three threads are running (the project is called HelloCpp).</p>

<p>thread-monitor-example.png</p>

<p>The above program has the following output.</p>
<pre>This thread was passed 0
This thread was passed 1
Thread 0 is completing
Thread 1 is completing
done
</pre>
    </div>

  
    <ul class="list-inline">
      <li><i class="fa fa-folder-open"></i></li>
      
      


  
     
    	<li><a href="/categories.html#coactionos-tutorials-ref">
    		coactionos-tutorials <span class="badge">11</span>
    	</a></li>
    
  


    </ul>
    

  
    <ul class="list-inline">
      <li><i class="fa fa-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#coaction-ref">coaction <span class="badge">18</span></a></li>
     
    	<li><a href="/tags.html#tutorial-ref">tutorial <span class="badge">11</span></a></li>
    
  



    </ul>
    

    <div class="pagination">
      <center>
        
          <a href="/coactionos-tutorials/2013/12/24/CoActionOS-Tutorial-Strings" type="button" class="btn btn-primary"><i class="fa fa-arrow-left"></i></a>
        
          <a href="/archive.html" type="button" class="btn btn-primary"><i class="fa fa-archive"></i></a>
        
          <a href="/coactionos-tutorials/2013/12/24/CoActionOS-Tutorial-Uart" type="button" class="btn btn-primary"><i class="fa fa-arrow-right"></i></a>
        
      </center>
    </div>
  </div>
</div>

</div>
				<div class="col-md-4">
					<h2>Embedded C Tutorial</h2>
					<ul> 


  
    
      
      	
      	<li><a href="/c-tutorial/2013/12/20/Embedded-C-Tutorial-Hello-World">Hello World</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/c-tutorial/2013/12/14/Embedded-C-Tutorial-Raw-Types">Raw Types</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/c-tutorial/2013/12/14/Embedded-C-Tutorial-Preprocessor">Preprocessor</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/c-tutorial/2013/12/14/Embedded-C-Tutorial-Pointers-and-Arrays">Pointers and Arrays</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/c-tutorial/2013/12/14/Embedded-C-Tutorial-Operators">Operators</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/c-tutorial/2013/12/14/Embedded-C-Tutorial-Keyword-Reference">Keywords Reference</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/c-tutorial/2013/12/14/Embedded-C-Tutorial-Functions">Functions</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/c-tutorial/2013/12/14/Embedded-C-Tutorial-Flow-Control">Flow Control</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/c-tutorial/2013/12/14/Embedded-C-Tutorial-Compound-Data-Types">Compound Data Types</a></li>
      	
      
    
  



					</ul>
				</div>
			</div>

		</div>
	</div>
	<hr>
	<footer>
		<div class="container">
			<div class="row">
				<div class="col-md-offset-1 col-md-9">
					<p>&copy; 2013 CoActionOS, Inc</p>
				</div>
			</div>
		</div>
	</footer>
	
</body>
</html>

